<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 11.00.9600.18792"></meta></head><body>
<h1 align="left">Механизм описания связей объектов</h1>
<h2 align="left">Оглавление</h2>
<ol><li><a href="#Термины"><font color="#0066cc">Термины и сокращения</font></a> 
</li><li><a href="#Описание"><font color="#0066cc">Общее описание механизма</font></a> 
</li><li><a href="#Принципы"><font color="#0066cc">Общие принципы работы</font></a> 
</li><li><a href="#Настройка"><font color="#0066cc">Порядок и принципы настройки механизма</font></a> </li></ol><a name="#Термины">
<h2>Термины и сокращения</h2>
<p></p></a>
<table width="100%"><tbody><tr><td><strong>Термин</strong></td>
<td><strong>Описание</strong></td></tr><tr><td>Механизм</td>
<td>Описываемый механизм описания связей объектов</td></tr><tr><td>Объект связи</td>
<td>Объект, который будет в результате найден</td></tr><tr><td>Вид объекта условия отбора</td>
<td>Вид объекта, по значениям реквизитов которого будут искаться Объекты связи</td></tr><tr><td>Входящий объект</td>
<td>Экземпляр объекта вида «Вид объекта условия отбора», поступающий на вход механизма</td></tr><tr><td>Условия отбора</td>
<td>Набор правил, задающих условия определения Входящего объекта</td></tr><tr><td>Связь</td>
<td>Элемент справочника «Связи объектов», описывающий одну конкретную связь между Объектом связи и Входящим объектом.</td></tr><tr><td>УОН</td>
<td>Управление объектами недвижимости – программная система, в которой реализован Механизм</td></tr></tbody></table><a name="#Описание">
<h2>Общее описание механизма</h2></a>
<p>Механизм предназначен для определения набора Объектов связи для каждого Входящего объекта. То есть, имея объект, мы можем найти для него набор связанных объектов (Объектов связи).</p>
<p>Настройки механизма позволяют задать для Объекта связи условия, которые определят, найдется ли данная Связь (и, соответственно, Объект связи) для Входящего объекта. Таким образом, условия связи формируются со стороны Объекта связи, но используются со стороны Входящего объекта. И применяются не к результату, а к входящим данным.</p>
<p>Механизм позволяет формировать Связи, хранить их и использовать внешними механизмами, как для определения наличия Связей для Входящего объекта, так и для получения перечня Объектов связи, соответствующих этим Связям.<br>Основное назначение механизма - быстрый поиск Объектов связи по Входящему объекту.</p>
<p><img src="_files/ОСиО_БП_ПП.png" width="589" height="593"></img><br>Рисунок 1. Элемент описания Связи.</p>
<p align="left">В данном примере (Рисунок 1) имеем:</p>
<ul><li><em>Объект связи</em> - "Схема Документ.ПлатежноеПоручениеИсходящее", 
</li><li><em>Вид объекта связи</em> - "Справочник._СхемыБизнесПроцессов", 
</li><li><em>Вид объекта условия отбора</em> - "Документ.ПлатежноеПоручениеИсходящее", 
</li><li><em>Условие отбора</em> - проведенность документа. </li></ul><p>В результате приведенных настроек, указанная схема бизнес-процесса будет доступна в поиске (найдена) для проведенного экземпляра документа "ПлатежноеПоручениеИсходящее".</p>
<p>Для использования механизма в программных разработках существуют точки входа и выхода (функции общего модуля), описанные в <strong>ПЗ №УОН-1-1-14 "Механизм описания связей объектов"</strong>.</p><a name="#Принципы">
<h2>Общие принципы работы</h2></a>
<p>Механизм связывает между собой Входящие объекты указанного вида (Вид объекта условия отбора), удовлетворяющие Условию (Условиям) отбора и Объект связи, являющий собой основание Связи. Т.е. позволяет получить для конкретного Входящего объекта перечень Связей (и указанных в них Объектов связи), Условиям отбора которых он удовлетворяет.</p>
<p>При обращении к Механизму со стороны Входящего объекта, он определяет все Связи по Условиям отбора, описанным для этого Входящего объекта:</p>
<ul><li>Вид Входящего объекта, для которого ищем связи, соответствует виду, указанному в поле "Вид объекта условия отбора", 
</li><li>Входящий объект удовлетворяет всем условиям, описанным в перечне Условий отбора. </li></ul><p>Из полученного набора Связей, извлекается набор объектов, указанных в поле "Объект связи" каждого из элементов набора. Полученный перечень Объектов связи возвращается пользователю Механизма для дальнейшей работы.</p><a name="#Настройка">
<h2>Порядок и принципы настройки механизма</h2></a>
<p>Механизм может быть использован как интерактивно, так и программно. Для интерактивного использования механизма необходимо, что бы доступ к нему был предоставлен непосредственно в форме связываемого объекта (например, в форме "Схемы БП" на вкладке «Привязки» см. Рисунок 1). Если таковое не реализовано, то потребуется выполнить настройку Связей через непосредственный доступ к справочникам:</p>
<ul><li><em>Описание связей объектов</em> - для описания самих Связей между Объектом связи и Входящим объектом указанного в Связи вида (Вид объекта условия отбора), 
</li><li><em>Условия отбора</em> - для описания и хранения Условий отбора, 
</li><li><em>Дополнение условий отбора</em> - для расширения перечня данных, используемых в Условиях отбора. </li></ul><p>В общем случае Механизм не имеет вынесенных в интерфейсы УОН средств настройки, потому настройка Связей производится непосредственно в процессе работы с объектами Механизма.</p>
<p>Далее описан пример настройки, приведенной на рисунке (Рисунок 1).</p>
<p>В форме элемента справочника «Описание связи»:</p>
<ul><li>Заполнить параметры связи с Объектом справочника "_СхемыБизнесПроцессов": 
<ul><li>Вид объекта связи (Справочник «Схемы бизнес-процессов») 
</li><li>Объект связи (сформированный нами экземпляр элемента справочника)</li></ul></li><li>Указать незаполненные параметры условия связи: 
<ul><li>Вид объекта условия связи - определяет, какого вида Входящий объект получит доступ к данной Связи (на рисунке указан элемент справочника "Виды объектов конфигурации" Документ.ПлатежноеПоручениеИсходящее, т.е. доступ к Связи получит документ этого вида) 
</li><li>Добавить (если необходимо) набор Условий отбора для применения Связи. Отдельные условия объединяются через "И" (на рисунке указано условие проведенности ПлатежногоПорученияИсходящего). </li></ul></li></ul><p>В форме настройки «Условия отбора» (Рисунок 2):</p>
<p><img src="_files/УО.png" width="702" height="382"></img><br>Рисунок 2. Форма настройки Условия отбора.</p>
<ul><li>В поле "Наименование" ввести краткое имя условия, отражающее его назначение, 
</li><li>В поле "Родитель", если необходимо, указать группу справочника для размещения данного условия, 
</li><li>В поле "Вид объекта" указывается Вид объекта условия отбора из справочника "Виды объектов метаданных", 
</li><li>На вкладке "Описание" написать текст, отражающий назначение условия, 
</li><li>Перейти на вкладку "Настройка", 
</li><li>На закладке "Отбор" ввести набор выражений, описывающих Условие отбора. На этой странице, в таблице правил отбора, доступны реквизиты Вида объекта условия отбора. Так же на закладке могут быть доступны дополнения условий отбора (дополнительные поля см. Рисунок 3), описание которых представлено ниже (Рисунок 4). 
</li><li>На закладке "Доп. поля" описать дополнительные поля, если такие нужны для формирования условий. 
</li><li>Все правила отбора, и дополнительные поля описываются согласно общим правилам работы с Системой Компоновки Данных 1С. </li></ul><p><img src="_files/ДУОвУО.png" width="318" height="307"></img><br>Рисунок 3. Выбор дополненных полей в форме настроек Условия отбора.</p>
<p>Справочник "Дополнения условий отбора":</p>
<p>Справочник предназначен для расширения перечня доступных полей в таблице правил отбора. Справочник должен быть заполнен до начала заполнения Условий отбора. В результате дополненные поля из этого механизма смогут быть добавлены к основному списку условий отбора (Рисунок 3).</p>
<p><img src="_files/ДУО.png"></img><br>Рисунок 4. Форма элемента справочника "Дополнения условий отбора"</p>
<p>Для настройки дополнений условий отбора необходимо (Рисунок 4):</p>
<ul><li>Указать краткое наименование, отражающее суть настройки. 
</li><li>В поле «Родитель» указать, если необходимо, группу справочника «Дополнения условий отбора» для помещения туда редактируемого элемента настроек. 
</li><li>На вкладке «Описание» ввести краткое содержание и назначение настроек. 
</li><li>На вкладке «Настройка» нужно описать механизм получения денных. Для этого: 
<ul><li>В поле «Имя набора данных» ввести имя набора, как оно появится в настройках «Условий отбора». Имя должно быть сформировано согласно правилам встроенного языка 1С. 
</li><li>В поле «Текст запроса» нужно описать запрос к данным, который вернет требуемые нами поля. Для облегчения формирования запроса можно воспользоваться «Конструктором запроса». 
</li><li>После описания текста запроса, при отсутствии ошибок, в таблице «Поля запроса» появится перечень полей, сформированных запросом. Таблица заполняется автоматически и не подлежит редактированию. 
</li><li>В таблице «Настройка связи с объектом» обязательно должна быть заполнена хотя бы одна связь. Эта таблица описывает связь исходного объекта, либо его табличных частей (при указании «Источника связи») с данными, полученными в запросе. Заполняется так же, как соответствующая вкладка «Связи» в Системе Компоновки Данных 1С. По умолчанию в таблице всегда есть строка, описывающая связь «все-со-всеми» (Рисунок 4). </li></ul></li><li>После завершения настройки дополнений, в перечне полей «Условий отбора» по тому же виду объекта появятся полученные нами поля, как это показано на рисунке (Рисунок 3). 
</li><li>Если форма настройки условий была открыта в процессе формирования дополнений, то ее потребуется закрыть и открыть повторно. </li></ul><p>Результатом настройки является то, что Входящий объект указанного нами в поле «Вид объекта условия отбора» вида данных (в нашем примере - «Платежное поручение исходящее»), при соблюдении им поставленных Условий отбора (в примере мы указали только необходимость его проведенности), получит доступ к Объекту связи, для которого мы описали нашу Связь (в примере – экземпляр справочника «Схемы бизнес-процессов» - «Схема Документ.ПлатежноеПоручениеИсходящее»).</p>
<p>Настройка связи является завершенной тогда, когда, как минимум, указаны:</p>
<ul><li>Наименование связи (может быть заполнено автоматически при указании объекта основания связи), 
</li><li>Вид объекта основания связи, 
</li><li>Объект - основание связи, 
</li><li>Вид объекта условия отбора. </li></ul><p>При заполнении этого необходимого минимума, объекту вида условия отбора будет доступен через описанный Механизм объект - основание связи.</p></body></html>